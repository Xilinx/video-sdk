<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
<!-- End Google Tag Manager -->
  <title>Container Setup &mdash; Xilinx Video SDK 1.5 (Production) documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials and Examples" href="examples.html" />
    <link rel="prev" title="Getting Started on Amazon EC2 VT1" href="getting_started_on_vt1.html" /> 
</head>

<body class="wy-body-for-nav">

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
<!-- End Google Tag Manager --> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="index.html" class="icon icon-home"> Xilinx Video SDK
            <img src="_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_on_prem.html">On Premises</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_on_vt1.html">Amazon EC2 VT1</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Container Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#working-with-docker-vt1">Working with Docker Amazon EC2 VT1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-docker-image-for-vt1-usage">Creating a Docker Image for Amazon EC2 VT1 Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#launching-a-docker-container-on-vt1">Launching a Docker Container on Amazon EC2 VT1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-docker-on-premises">Working with  Docker On-Premises</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-docker-image-for-on-prem-usage">Creating a Docker Image for On-Prem Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#launching-a-docker-container-on-premises">Launching a Docker Container On-Premises</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Tutorials and Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="specs_and_features.html">Specs and Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_ffmpeg.html">Using FFmpeg</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_compute_resources.html">Managing Compute Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploying_with_kubernetes.html">Deploying with Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_apis.html">C API Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="card_management.html">Card Management</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Xilinx/video-sdk/issues">File an issue</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/video-sdk/browse.html">Other versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Xilinx Video SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Container Setup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/container_setup.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="container-setup">
<span id="id1"></span><h1>Container Setup<a class="headerlink" href="#container-setup" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#working-with-docker-vt1" id="id2">Working with Docker Amazon EC2 VT1</a></p></li>
<li><p><a class="reference internal" href="#working-with-docker-on-premises" id="id3">Working with  Docker On-Premises</a></p></li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The Github repository for the Xilinx Video SDK includes predefined <a class="reference external" href="https://github.com/Xilinx/video-sdk/tree/v1.5/dockerfiles">dockerfiles</a> which can be used to easily create Docker images with the Xilinx Video SDK for different OS configurations. There are different Dockerfiles for on-prem and Amazon EC2 VT1 usage. The Dockerfiles included in the repository can be used as-is or customized based on end-user needs.</p>
<p>The instructions below explain how to create and then launch a Docker image from one of the Dockerfiles included in the Xilinx Video SDK repository.</p>
<p>A working installation of Docker is required.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="working-with-docker-vt1">
<h2><a class="toc-backref" href="#id2">Working with Docker Amazon EC2 VT1</a><a class="headerlink" href="#working-with-docker-vt1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-a-docker-image-for-vt1-usage">
<h3>Creating a Docker Image for Amazon EC2 VT1 Usage<a class="headerlink" href="#creating-a-docker-image-for-vt1-usage" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>If not already available, clone the video-sdk repository on your machine:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/Xilinx/video-sdk -b v1.5 --depth 1
</pre></div>
</div>
</li>
<li><p>Navigate to the root of the video-sdk repository:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cd path/to/video-sdk
</pre></div>
</div>
</li>
<li><p>Build the docker image using the supplied Dockerfile corresponding to the desired OS:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>docker build -t video_sdk_image:v1 -f dockerfiles/vt1/Dockerfile.&lt;Desired OS&gt; .
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="launching-a-docker-container-on-vt1">
<span id="launch-docker-vt1"></span><h3>Launching a Docker Container on Amazon EC2 VT1<a class="headerlink" href="#launching-a-docker-container-on-vt1" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Gather the User BDFs and renderIDs of the Xilinx devices present in your system. For detailled information on how to do this, refer to the instructions for looking-up the <a class="reference internal" href="card_management.html#device-bdf"><span class="std std-ref">User BDF</span></a> and <a class="reference internal" href="card_management.html#device-render-id"><span class="std std-ref">renderID</span></a>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>xbutil examine
...
ls /sys/bus/pci/devices/&lt;Domain&gt;\:&lt;Bus&gt;\:&lt;Device&gt;.&lt;Function&gt;/drm
</pre></div>
</div>
</li>
<li><p>Run the Docker container using the <code class="docutils literal notranslate"><span class="pre">--device</span></code> option with the renderID (user function port) of the desired devices to make them accessible by the container:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>docker run -it --device=/dev/dri/renderD&lt;ID1&gt;:/dev/dri/renderD&lt;ID1&gt;
               --device=/dev/dri/renderD&lt;ID2&gt;:/dev/dri/renderD&lt;ID2&gt;
               video_sdk_image:v1 /bin/bash
</pre></div>
</div>
</li>
<li><p>Once in the container, validate that the desired devices have been successfully mapped and can properly be used:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>source /opt/xilinx/xrt/setup.sh
xbutil examine
</pre></div>
</div>
</li>
</ol>
<p class="rubric">NOTES</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">xbutil</span> <span class="pre">reset</span></code> command should not be used from within containers running on Amazon EC2 VT1 instances. The command will kill any job running on the devices, but it will not reset the devices.</p></li>
<li><p>AWS has created a script to automatically generate the <code class="docutils literal notranslate"><span class="pre">--device</span></code> option with the renderID of all available devices. The script can be found <a class="reference external" href="https://raw.githubusercontent.com/Xilinx/Xilinx_Base_Runtime/master/utilities/xilinx_aws_docker_setup.sh">here</a> Details about how to use this script can be found on the AWS Compute Blog: <a class="reference external" href="https://aws.amazon.com/blogs/compute/deep-dive-on-amazon-ec2-vt1-instances/">https://aws.amazon.com/blogs/compute/deep-dive-on-amazon-ec2-vt1-instances/</a></p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="working-with-docker-on-premises">
<h2><a class="toc-backref" href="#id3">Working with  Docker On-Premises</a><a class="headerlink" href="#working-with-docker-on-premises" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-a-docker-image-for-on-prem-usage">
<h3>Creating a Docker Image for On-Prem Usage<a class="headerlink" href="#creating-a-docker-image-for-on-prem-usage" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>If not already available, clone the video-sdk repository on your machine:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/Xilinx/video-sdk -b v1.5 --depth 1
</pre></div>
</div>
</li>
<li><p>Navigate to the root of the video-sdk repository:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cd path/to/video-sdk
</pre></div>
</div>
</li>
<li><p>Build the docker image using the supplied Dockerfile corresponding to the desired OS:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>docker build -t video_sdk_image:v1 -f dockerfiles/on_prem/Dockerfile.&lt;Desired OS&gt; .
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="launching-a-docker-container-on-premises">
<span id="launch-docker-on-prem"></span><h3>Launching a Docker Container On-Premises<a class="headerlink" href="#launching-a-docker-container-on-premises" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Gather the User BDFs and renderIDs of the Xilinx devices present in your system. For detailled information on how to do this, refer to the instructions for looking-up the <a class="reference internal" href="card_management.html#device-bdf"><span class="std std-ref">User BDF</span></a> and <a class="reference internal" href="card_management.html#device-render-id"><span class="std std-ref">renderID</span></a>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>xbutil examine
...
ls /sys/bus/pci/devices/&lt;Domain&gt;\:&lt;Bus&gt;\:&lt;Device&gt;.&lt;Function&gt;/drm
</pre></div>
</div>
</li>
<li><p>Gather the Management BDFs and xclmgmtID of the Xilinx devices present in your system. For detailled information on how to do this, refer to the instructions for looking-up the <a class="reference internal" href="card_management.html#device-management-bdf"><span class="std std-ref">Management BDF</span></a> and <a class="reference internal" href="card_management.html#device-xclmgmt-id"><span class="std std-ref">xclmgmtID</span></a>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>xbmgmt examine
...
cat /sys/bus/pci/devices/&lt;Domain&gt;\:&lt;Bus&gt;\:&lt;Device&gt;.&lt;Function&gt;/instance
</pre></div>
</div>
</li>
<li><p>Run the Docker container using the <code class="docutils literal notranslate"><span class="pre">--device</span></code> option with the renderID (user function port) and the xclmgmtID (management function port) of the desired devices to make them accessible by the container:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>docker run -it --device=/dev/dri/renderD&lt;ID1&gt;:/dev/dri/renderD&lt;ID1&gt; --device=/dev/xclmgmt&lt;ID1&gt;:/dev/xclmgmt&lt;ID1&gt;
               --device=/dev/dri/renderD&lt;ID2&gt;:/dev/dri/renderD&lt;ID2&gt; --device=/dev/xclmgmt&lt;ID2&gt;:/dev/xclmgmt&lt;ID2&gt;
               video_sdk_image:v1 /bin/bash
</pre></div>
</div>
</li>
<li><p>Once in the container, validate that the desired devices have been successfully mapped and can properly be used:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>source /opt/xilinx/xrt/setup.sh
xbutil examine
</pre></div>
</div>
</li>
</ol>
<p class="rubric">NOTES</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">xbutil</span> <span class="pre">reset</span></code> command will reset the specified device as well as all other devices present on the same Xilinx card, even if these other devices are not mapped to the container. In order to avoid reset conflicts, Xilinx strongly recommends mapping all the devices of a given card when running the container. For details on how to determine which devices are on the same card, consult the following instructions: <a class="reference internal" href="card_management.html#mapping-devices-to-cards"><span class="std std-ref">Mapping Devices to Cards</span></a>.</p></li>
<li><p>In the case where a single device is mapped to the container, Xilinx recommends against using the <code class="docutils literal notranslate"><span class="pre">xbutil</span> <span class="pre">reset</span></code> command.</p></li>
<li><p>Mapping the management port using the xclmgmtID allows using to the <code class="docutils literal notranslate"><span class="pre">xbmgmt</span></code> card management utility from within the container. Doing so is optional.</p></li>
</ul>
</div>
</div>
</div>


           </div>
          </div>
          
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="getting_started_on_vt1.html" class="btn btn-neutral float-left" title="Getting Started on Amazon EC2 VT1" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="Tutorials and Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2023, Advanced Micro Devices, Inc.
      <span class="lastupdated">Last updated on August 16, 2023.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>